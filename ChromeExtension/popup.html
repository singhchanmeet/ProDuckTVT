<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="style.css" />
    <title>ProDuckTVT</title>
    <style>
      .tab-content {
        display: none;
      }

      .active-tab {
        display: block;
      }
    </style>
  </head>

  <body>
    <div class="active-tab w-[350px] h-[550px] bg-zinc-800 text-white">
      <div class="flex justify-between py-2 px-3 items-center bg-black">
        <img src="logo.png" alt="ducky" class="w-14" />
        <h1 class="cursor-pointer font-semibold text-yellow-600 text-xl">ProDuckTVT</h1>
        <h2 class="text-lg">X</h2>
      </div>
      <div class="flex justify-center text-lg font-semibold bg-black">
        <button class="py-2 bg-zinc-800 px-4 text-zinc-400 rounded-t border-black border-r-[1px] hover:text-white">For
          Gamers</button>
        <button
          class="py-2 bg-zinc-800 px-4 text-zinc-400 rounded-t border-black border-l-[1px] hover:text-white">Development</button>
      </div>
      <div class="main-content px-2">
        <br />
        <div class="flex justify-between">
          <p class="font-mono text-yellow-300">
            Enhance your <span class="">productivity</span>. <br />
            For all <span>developers</span> &
            <span>gamers</span>.
          </p>
          <button class="styled-button font-mono hover:text-yellow-400"><a href="">Visit Website</a></button>
        </div>
        <br>
        <hr />
        <br>
        <h2 class="text-lg text-yellow-600">Develop and Code:</h2>
        <div class="flex gap-2">
          <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="">Save Code Snippet</a></button>
          <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="">Open Documentation</a></button>
        </div>
        <br>
        <div class="recording">
          <h2 class="text-lg text-yellow-600">Recording and streaming</h2>
          <div class="flex gap-2 ">
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400" id="openTabButton">
              <a href="./screen-recording/dropdown.html">Start Screen Recording</a>
            </button>
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="./">Share your Screen</a></button>
          </div>
        </div>
        <br>
        <div class="recording">
          <h2 class="text-lg text-yellow-600">Others</h2>
          <div class="flex gap-2 flex-wrap">
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400" id="openTabButton">
              <a href="./screen-recording/dropdown.html">Browsing Analytics</a>
            </button>
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="./">Toggle Dark mode</a></button>
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="./">Our VS Code Extension</a></button>
            <button class="shadowed-btn p-2 bg-zinc-600 hover:bg-zinc-400"><a href="./">Our Discord Bot</a></button>
          </div>
        </div>
      </div>
    </div>
    <div class="tab-content">
      <article id="default-section">
        <div class="btn" id="full-screen">
          <section><img src="images/main-icon.png" /></section>
          Screen Only (without audio)
        </div>
        <hr />
        <div class="btn" id="microphone-screen">
          <section><img src="images/main-icon.png" /></section>
          Screen + Microphone
        </div>
        <hr />
        <div class="btn" id="full-screen-audio">
          <section><img src="images/main-icon.png" /></section>
          Screen + Speakers
        </div>
        <hr />
        <div class="btn" id="full-screen-microphone-audio">
          <section><img src="images/main-icon.png" /></section>
          Screen + Microphone + Speakers
        </div>
        <hr />
        <div class="btn" id="selected-tab">
          <section><img src="images/main-icon.png" /></section>
          Chrome Tab
        </div>
        <hr />
        <div class="btn" id="selected-tab-audio-only">
          <section><img src="images/main-icon.png" /></section>
          Chrome Tab (Audio Only)
        </div>
        <hr />
        <div class="btn" id="microphone-screen-camera">
          <section><img src="images/main-icon.png" /></section>
          Full Screen + Camera
        </div>
        <hr />
        <div class="btn" id="microphone-webcam">
          <section><img src="images/main-icon.png" /></section>
          Microphone + Camera
        </div>
        <hr />
        <div class="btn" id="microphone-speakers">
          <section><img src="images/main-icon.png" /></section>
          Microphone + Speakers
        </div>
        <hr />
        <div class="btn" id="microphone-only">
          <section><img src="images/main-icon.png" /></section>
          Microphone Only
        </div>
        <hr />
        <div class="btn" id="speakers-only">
          <section><img src="images/main-icon.png" /></section>
          Speakers Only
        </div>
        <hr />
        <div style="float: right">
          <a href="preview.html" target="_blank">See All Recordings</a>
        </div>
        <div>
          <a id="btn-options" href="options.html" target="_blank">Options</a>
        </div>
      </article>

      <article id="stop-section">
        <div class="btn" id="stop-recording">
          <section><img src="images/recordRTC-progress-1.png" /></section>
          Stop Recording
        </div>
      </article>
    </div>

    <script>
      // JavaScript to handle tab switching
      openTabButton = document.getElementById('openTabButton')
      tabContents = document.getElementsByClassName('.tab-content')

      openTabButton.addEventListener('onclick', () => {
        // Hide all tab contents
        tabContents.forEach(tabContent => {
          tabContent.style.display = 'none'
        })

        // Display the first tab content
        document.getElementById('tab1').style.display = 'block'
      })

      var runtimePort = chrome.runtime.connect({
        name: location.href
          .replace(/\/|:|#|\?|\$|\^|%|\.|`|~|!|\+|@|\[|\||]|\|*. /g, '')
          .split('\n')
          .join('')
          .split('\r')
          .join('')
      })

      runtimePort.onMessage.addListener(function (message) {
        if (!message || !message.messageFromContentScript1234) {
          return
        }
      })

      var isRecording = false
      chrome.storage.sync.get('isRecording', function (obj) {
        document.getElementById('default-section').style.display =
          obj.isRecording === 'true' ? 'none' : 'block'
        document.getElementById('stop-section').style.display =
          obj.isRecording === 'true' ? 'block' : 'none'

        isRecording = obj.isRecording === 'true'

        // auto-stop-recording
        if (isRecording === true) {
          document.getElementById('stop-recording').click()

          chrome.tabs.query({}, function (tabs) {
            var tabIds = []
            var url = 'chrome-extension://' + chrome.runtime.id + '/video.html'
            for (var i = tabs.length - 1; i >= 0; i--) {
              if (tabs[i].url === url) {
                tabIds.push(tabs[i].id)
                chrome.tabs.update(tabs[i].id, {
                  active: true,
                  url: url
                })
                break
              }
            }
            if (tabIds.length) {
              chrome.tabs.remove(tabIds)
            }
          })
        }
      })

      document.getElementById('stop-recording').onclick = function () {
        chrome.storage.sync.set(
          {
            isRecording: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              stopRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('full-screen').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'false',
            enableCamera: 'false',
            enableScreen: 'true',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('full-screen-audio').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'false',
            enableCamera: 'false',
            enableScreen: 'true',
            isRecording: 'true',
            enableSpeakers: 'true'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('full-screen-microphone-audio').onclick =
        function () {
          chrome.storage.sync.set(
            {
              enableTabCaptureAPI: 'false',
              enableTabCaptureAPIAudioOnly: 'false',
              enableMicrophone: 'true',
              enableCamera: 'false',
              enableScreen: 'true',
              isRecording: 'true',
              enableSpeakers: 'true'
            },
            function () {
              runtimePort.postMessage({
                messageFromContentScript1234: true,
                startRecording: true,
                dropdown: true
              })
              window.close()
            }
          )
        }

      document.getElementById('selected-tab').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'true',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'false',
            enableCamera: 'false',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('selected-tab-audio-only').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'true',
            enableTabCaptureAPIAudioOnly: 'true',
            enableMicrophone: 'false',
            enableCamera: 'false',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('microphone-screen').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'true',
            enableCamera: 'false',
            enableScreen: 'true',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('microphone-screen-camera').onclick =
        function () {
          chrome.storage.sync.set(
            {
              enableTabCaptureAPI: 'false',
              enableTabCaptureAPIAudioOnly: 'false',
              enableMicrophone: 'true',
              enableCamera: 'true',
              enableScreen: 'true',
              isRecording: 'true',
              enableSpeakers: 'false'
            },
            function () {
              runtimePort.postMessage({
                messageFromContentScript1234: true,
                startRecording: true,
                dropdown: true
              })
              window.close()
            }
          )
        }

      document.getElementById('microphone-webcam').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'true',
            enableCamera: 'true',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('microphone-speakers').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'true',
            enableCamera: 'false',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'true'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('microphone-only').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'true',
            enableCamera: 'false',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'false'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('speakers-only').onclick = function () {
        chrome.storage.sync.set(
          {
            enableTabCaptureAPI: 'false',
            enableTabCaptureAPIAudioOnly: 'false',
            enableMicrophone: 'false',
            enableCamera: 'false',
            enableScreen: 'false',
            isRecording: 'true',
            enableSpeakers: 'true'
          },
          function () {
            runtimePort.postMessage({
              messageFromContentScript1234: true,
              startRecording: true,
              dropdown: true
            })
            window.close()
          }
        )
      }

      document.getElementById('btn-options').onclick = function (e) {
        e.preventDefault()
        location.href = this.href
      }
    </script>
    <script src="./script.js"></script>
  </body>
</html>
